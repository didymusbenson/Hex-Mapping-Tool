<!DOCTYPE html>

<head>
    <title>Hex</title>
    <script src="hexagon.js"></script>

    <style>
        input {
            width: 75px;
            text-align: center;
        }
        #HexCanvas{border:1px solid black;}

    </style>
</head>

<body>
    <div id="CANVASHOLDER">
        <canvas id="HexCanvas" width="1000" height="700"></canvas>
    </div>
    <br>
    <input type="text" id="hw" placeholder="Hex Size">
    <input type="text" id="hr" placeholder="# Rows">
    <input type="text" id="hc" placeholder="# Columns">
    <button onclick="redraw()">DRAW</button>

    <br>
    <br>
    <button onclick="setColor('blue')">water</button>
    <button onclick="setColor('red')">mountain</button>
    <button onclick="setColor('green')">forest</button>
    <button onclick="setColor('yellow')">plains</button>
    <button onclick="setColor('black')">swamp</button>
    <br>
    <br>
    <button><a id="download" download="Map.jpg">download as image</a></button>
    <script>
        //INSTANTIATE FIRST HEXAGON GRID
        // HexagonGrid("NAME", HEX WIDTH)
        var hexagonGrid = new HexagonGrid("HexCanvas", 40, 7, 11);
        // drawHexGrid(rows, columns, left, top, DEBUGTEXT)
        hexagonGrid.drawHexGrid(7, 11, 10, 10, false);

        function download() {
                var dt = document.getElementById("HexCanvas").toDataURL('image/jpeg');
                this.href = dt;
        };

document.getElementById("download").addEventListener('click', download, false);

        function redraw() {

            var width = Number(document.getElementById("hw").value);
            var rows = Number(document.getElementById("hr").value);
            var cols = Number(document.getElementById("hc").value);

            // .886 is the basic ratio you need
            var heightNeeded;
            var stupidMath = ((Math.sqrt(Math.pow(width,2) - Math.pow((width/2),2))) * 2)

                heightNeeded = stupidMath * rows + (stupidMath / 2);


            var widthNeeded = (cols * width * 1.7);
            console.log("widthneeded: " + widthNeeded+ ", heightneeded: " + heightNeeded);

            document.getElementById("CANVASHOLDER").innerHTML = "<canvas id='HexCanvas' width='"+ widthNeeded +"' height='"+heightNeeded+"'></canvas>";

            var canvas = document.getElementById("HexCanvas");
            var context = canvas.getContext("2d");
            context.clearRect(0, 0, canvas.width, canvas.height);


            hexagonGrid = new HexagonGrid("HexCanvas", width, rows, cols);
            hexagonGrid.drawHexGrid(rows, cols, 0, 0, false)
            console.log("width: " + width + ", rows: " + rows + ", cols: " + cols);
        }

        function setColor(color) {
            hexagonGrid.setDrawColor(color);
        }



    </script>

</body>
